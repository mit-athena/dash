/*
 *  Imakefile for Athena Dashboard
 *  Copyright (c) 1991, Massachusetts Institute of Technology
 *		
 *   $Source: /afs/dev.mit.edu/source/repository/athena/bin/dash/src/dash/Imakefile,v $
 *   $Author: ghudson $ 
 *
 * Copyright 1990, 1991 by the Massachusetts Institute of Technology. 
 *
 * For copying and distribution information, please see the file
 * <mit-copyright.h>. 
 *
 */

#include "../Xj.defs"

#include "mit-copyright.h"

DASH		=	dash
DASHRESOURCES	=	Dash

#if defined(HaveKerberos)
K_DEF		=	-DKERBEROS
K_LIB		=	-lkrb4 -ldes425 -lkrb5 -lcrypto -lcom_err
K_SRC		=	klist.c
K_OBJ		=	klist.o
#else  /* HaveKerberos */
K_DEF		=
K_LIB		=
K_LIST		=
K_OBJ		=
#endif /* HaveKerberos */

#if defined(HaveAttach)
A_DEF		=	-DATTACH
#else  /* HaveAttach */
A_DEF		=
#endif /* HaveAttach */


OBJS		=	dash.o ${K_OBJ}
SRCS		=	dash.c ${K_SRC}

XJLIB		=	../lib/libXj.a

#ifdef SOLARIS
OS_LIBS		=	-lbsd
#endif
D_LIBS		=	${LOCAL_LIBS} ${XJLIB} ${XLIB} \
			${XMULIB} ${K_LIB} ${M_LIB} ${OS_LIBS}
CMP_LIBS	=	${LOCAL_LIBS} ${XJLIB} -lX11 ${OS_LIBS}

#if defined(MacIIArchitecture)
M_LIB		=	-lmalloc
#else
M_LIB		=
#endif

DEFINES		=	${G_DEFINES} ${K_DEF} ${A_DEF}
INCLUDES	=	-I../lib ${LOCAL_INCLUDES}

AllTarget(${DASH})
AllTarget(${DASHRESOURCES})

NormalProgramTarget($(DASH),$(OBJS),$(XJLIB),,$(D_LIBS))
InstallProgram($(DASH),$(DASH_BIN_DIR))

InstallNonExecFile(${DASH}.1,${MAN_DIR}/man1)
InstallNonExecFile(${DASHRESOURCES},${DASH_APP_DIR})
InstallNonExecFile(arrow,${DASH_XBM_DIR})
InstallNonExecFile(gray,${DASH_XBM_DIR})
InstallNonExecFile(question,${DASH_XBM_DIR})
InstallNonExecFile(Dash.xbm,${DASH_XBM_DIR})

DependTarget()

#ifdef SGIArchitecture
FOREGROUND=black
BACKGROUND=\#9f9f9f
#else
FOREGROUND=black,black,midnightblue
BACKGROUND=white,gray85,CadetBlue2
#endif

$(DASHRESOURCES): Dash.pre-sed
	${RM} ${DASHRESOURCES}
	sed -e "s,DASH_MENUS,$(DASH_MENUS)," Dash.pre-sed | \
	sed -e "s,DASH_FALLBACK,$(DASH_FALLBACK)," | \
	sed -e "s/FOREGROUND/$(FOREGROUND)/" | \
	sed -e "s/BACKGROUND/$(BACKGROUND)/" > $(DASHRESOURCES)

clean::
	${RM} strings
	${RM} x.c

/* .c.o:
 *	${CC} ${CFLAGS} -E $*.c | xstr -c -
 *	${CC} ${CFLAGS} -c x.c
 *	mv x.o $*.o
 *	${RM} x.c
 *
 *xs.o:
 *	xstr
 *	${CC} ${CFLAGS} -c xs.c
 */
